{"name":"Ops","tagline":"Rack application for versioning and heartbeat info","body":"Ops\r\n===\r\n\r\n[![Code Climate](https://codeclimate.com/github/primedia/ops.png)](https://codeclimate.com/github/primedia/ops)\r\n\r\nThis gem provides standardized support for obtaining environment, version, and heartbeat information from Sinatra or Rails-based web applications.\r\n\r\n**You will likely want to block or restrict access to the following routes:**\r\n\r\nRoute         | Notes\r\n--------------| -----\r\n`/ops/env`    | Exposes all of your environment variables (e.g. any API keys set as environment variables) to the public\r\n`/ops/config` | Exposes all of your configuration keys and values to the public (if you're using a configuration service).\r\n\r\nTypical usage:\r\n\r\n```\r\n/ops/version      - displays version info as HTML\r\n/ops/version.json - displays version info as JSON\r\n/ops/heartbeat    - returns 'OK' if the app is alive\r\n/ops/env          - display the currently set environment variables\r\n/ops/config       - display all configuration values as JSON (optional)\r\n```\r\n\r\nThis gem replaces the now-deprecated [ops_routes](https://github.com/primedia/ops_routes).\r\n\r\nInstallation\r\n------------\r\n\r\n### For Rails 3 apps:\r\n\r\n1. Add the gem to your project's Gemfile:\r\n    ```ruby\r\n    gem 'ops'\r\n    ```\r\n\r\n2. Add the following to application.rb:\r\n\r\n    ```ruby\r\n    Ops.setup do |config|\r\n      config.file_root = Rails.root\r\n      config.environment = Rails.env\r\n      config.config_service_adapter = something_that_responds_to_call # optional\r\n    end\r\n    ```\r\n\r\n3. mount the gem in routes.rb:\r\n\r\n    ```ruby\r\n    mount Ops.new, :at => \"/ops\"\r\n    ```\r\n\r\n### For Sinatra apps:\r\n\r\n1. Add the gem to your project's Gemfile:\r\n\r\n    ```ruby\r\n    gem 'ops'\r\n    ```\r\n\r\n2. Add the following to config.ru:\r\n\r\n    ```ruby\r\n    require 'ops'\r\n\r\n    #...\r\n\r\n    Ops.setup do |config|\r\n      config.file_root = File.dirname __FILE__\r\n      config.environment = ENV['RACK_ENV']\r\n      config.config_service_adapter = something_that_responds_to_call # optional\r\n    end\r\n\r\n    run Rack::URLMap.new \\\r\n      \"/\"    => YourAppClass,\r\n      \"/ops\" => Ops.new\r\n    ```\r\n\r\n    ```ruby\r\n    # Implementation within rack cascade:\r\n    run Rack::Cascade.new([\r\n      NewHomeGuide,\r\n      ListingSearch::App,\r\n      Ops.rack_app('/ops')\r\n    ])\r\n    ```\r\n\r\nAdding Custom Heartbeats\r\n------------------------\r\n\r\nAdditionally, you can specify custom heartbeat monitoring pages as follows:\r\n\r\n```ruby\r\nOps.add_heartbeat :mysql do\r\n  conn = ActiveRecord::Base.connection\r\n  migrations = conn.select_all(\"SELECT COUNT(1) FROM schema_migrations;\")\r\n  conn.disconnect!\r\nend\r\n```\r\n\r\nThe mysql example shown above would be accessed at ops/heartbeat/mysql. The heartbeat page will return a `200 ‘OK’` as long as the provided block returns true. If an error is raised, the heartbeat does not exist, or the block returns a falsey value, a `500` will be returned instead.\r\n\r\n\r\n## The Configuration Service Adapter (Optional)\r\n\r\nIf you wish to use the optional configuration service, you must provide\r\nsomething that responds to `#call` with an optional `Hash` argument.\r\n\r\nFor example:\r\n\r\n```ruby\r\nclass MyConfigurationService\r\n  def call(options = {})\r\n    { key: 'value' }\r\n  end\r\nend\r\n```\r\n\r\nor\r\n\r\n```ruby\r\nProc.new { |_| { key: 'value' } }\r\n```\r\n\r\nThen just provide your \"callable\" per the installation instructions above.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}